## EVR RTEMS startup script

## Set common environment variables. eg. EPICS_TS_NTP_INET and PORTs
< /boot/g/lcls/epics/iocCommon/All/Dev/pre_st.cmd
setenv("EPICS_CA_MAX_ARRAY_BYTES","30000")
# by building one obj with everything in it, no lib/... link to ioc/lib/<target> is needed
chdir("../../")
ld("bin/RTEMS-beatnik/evr.obj") 

dbLoadDatabase("dbd/evr.dbd")

evr_registerRecordDeviceDriver(pdbbase) 

## Load record instances
dbLoadRecords("db/evrXL16.db")
dbLoadRecords("db/evrPatternXL16.db")
dbLoadRecords("db/trigXL16.db")
dbLoadRecords("db/bsaXL16.db")
#dbLoadRecords("db/bsaSimXL09.db")
#ErDebug=100
bspExtVerbosity=0

ErConfigure(0,0x000000,0x00,0,1)  # PMC type
ErConfigure(1,0x300000,0x60,4,0)  # VME type.
ErConfigure(2,0x400000,0x62,4,0)  # VME type

evrTimeFlag=0
iocInit() # after h/w initialisations
bspExtVerbosity=1
#mpsEvrStart(1)
